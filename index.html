<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–®–∏—Ñ—Ä—ã</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="progressBarContainer" class="progress-bar-container" style="display: none;">
        <div id="progressBar" class="progress-bar" style="width: 0%"></div>
    </div>

    <div class="container">
        <div id="alertContainer"></div>

        <!-- Login Section -->
        <div id="loginSection" class="login-container">
            <form id="passwordForm" onsubmit="return false;">
                <div class="password-display" id="passwordDisplay">****</div>
                <input type="hidden" id="passwordInput">

                <div class="numpad">
                    <button type="button" class="numpad-button" data-value="1">1</button>
                    <button type="button" class="numpad-button" data-value="2">2</button>
                    <button type="button" class="numpad-button" data-value="3">3</button>
                    <button type="button" class="numpad-button" data-value="4">4</button>
                    <button type="button" class="numpad-button" data-value="5">5</button>
                    <button type="button" class="numpad-button" data-value="6">6</button>
                    <button type="button" class="numpad-button" data-value="7">7</button>
                    <button type="button" class="numpad-button" data-value="8">8</button>
                    <button type="button" class="numpad-button" data-value="9">9</button>
                    <button type="button" class="numpad-button" data-value="C">C</button>
                    <button type="button" class="numpad-button" data-value="0">0</button>
                    <button type="button" class="numpad-button" data-value="E">‚Üµ</button>
                </div>
            </form>
        </div>

        <!-- Puzzle Section -->
        <div id="puzzleSection" class="puzzle-container" style="display: none;">
            <div class="puzzle-content" id="puzzleContent"></div>
            <form class="answer-form" id="answerForm" onsubmit="return false;">
                <input type="text" id="answerInput" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç">
                <button type="button" class="btn" onclick="checkAnswer()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
            </form>
        </div>

        <!-- Final Section -->
        <div id="finalSection" class="final-container" style="display: none;">
            <div class="final-message">
                –° –æ—Ç–≤–µ—Ç–∞–º–∏ –Ω–∞ –≤—Å–µ –∑–∞–≥–∞–¥–∫–∏ —Ç—ã –Ω–∞–π–¥–µ—à—å –∑–≤—ë–∑–¥—É,–æ–±—ä–µ–¥–∏–Ω–∏ –∏—Ö –≤—Å–µ—Ö –≤ –æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞–ø–∏—à–∏ @Divizion_of_Revichs, –∏ –≥–ª–∞–≤–Ω–æ–µ –¥—É–º–∞–π —à–∏—Ä–µ,–±—É–¥—å –ø–µ—Ä–≤—ã–º
            </div>
        </div>
    </div>

    <script>
        // State management
        let password = '';
        const maxLength = 4;
        let isLoggedIn = false;
        let solvedPuzzles = [];
        let currentPuzzleIndex = 0;

        // Puzzle data
        const puzzles = [
            "1=–ê 2=–ë 3=–í ... 26=–Ø: 13-9-18",
            "‚¨ÜÔ∏è‚¨ÜÔ∏è‚¨áÔ∏è‚¨áÔ∏è (–ö–û–ù–¢–†–ê)",
            "üåü + ‚≠êÔ∏è = ?",
            "üí° = ?",
            "üîë = ?",
            "üéÆ = ?",
            "‚öîÔ∏è = ?",
            "üéØ = ?",
            "üîç = ?",
            "‚ú® = ?",
            "üëë = ?",
            "üé≤ = ?",
            "üí™ = ?",
            "üî• = ?",
            "‚≠êÔ∏è = ?"
        ];

        const answers = [
            "min",
            "code",
            "star",
            "light",
            "key",
            "play",
            "fight",
            "win",
            "find",
            "magic",
            "king",
            "game",
            "power",
            "fire",
            "star"
        ];

        // Helper functions
        function showAlert(message, category) {
            const alertContainer = document.getElementById('alertContainer');
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${category}`;
            alertDiv.textContent = message;
            alertContainer.appendChild(alertDiv);
            setTimeout(() => alertDiv.remove(), 3000);
        }

        function updateProgressBar() {
            const progressBar = document.getElementById('progressBar');
            const percentage = (solvedPuzzles.length / puzzles.length) * 100;
            progressBar.style.width = `${Math.round(percentage)}%`;
        }

        function showSection(sectionId) {
            document.querySelectorAll('.container > div').forEach(div => {
                if (div.id === 'alertContainer') return;
                div.style.display = 'none';
            });
            document.getElementById(sectionId).style.display = 'flex';
        }

        function loadPuzzle() {
            if (currentPuzzleIndex < puzzles.length) {
                document.getElementById('puzzleContent').textContent = puzzles[currentPuzzleIndex];
                showSection('puzzleSection');
            } else {
                showSection('finalSection');
            }
        }

        function checkAnswer() {
            const userAnswer = document.getElementById('answerInput').value.trim().toLowerCase();
            if (userAnswer === answers[currentPuzzleIndex]) {
                if (!solvedPuzzles.includes(currentPuzzleIndex)) {
                    solvedPuzzles.push(currentPuzzleIndex);
                    localStorage.setItem('solvedPuzzles', JSON.stringify(solvedPuzzles));
                    updateProgressBar();
                }
                currentPuzzleIndex++;
                document.getElementById('answerInput').value = '';
                showAlert('–ü—Ä–∞–≤–∏–ª—å–Ω–æ!', 'success');
                loadPuzzle();
            } else {
                showAlert('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑', 'error');
            }
        }

        // Initialize UI state from localStorage
        document.addEventListener('DOMContentLoaded', () => {
            isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            solvedPuzzles = JSON.parse(localStorage.getItem('solvedPuzzles') || '[]');
            currentPuzzleIndex = solvedPuzzles.length;

            if (isLoggedIn) {
                document.getElementById('progressBarContainer').style.display = 'block';
                updateProgressBar();
                loadPuzzle();
            } else {
                showSection('loginSection');
            }
        });

        // Numpad functionality
        document.querySelectorAll('.numpad-button').forEach(button => {
            button.addEventListener('click', function() {
                const value = this.dataset.value;

                if (value === 'C') {
                    password = '';
                } else if (value === 'E') {
                    if (password === '19') {
                        isLoggedIn = true;
                        localStorage.setItem('isLoggedIn', 'true');
                        document.getElementById('progressBarContainer').style.display = 'block';
                        loadPuzzle();
                        showAlert('–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥', 'success');
                    } else {
                        showAlert('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å', 'error');
                        password = '';
                    }
                } else if (password.length < maxLength) {
                    password += value;
                }

                document.getElementById('passwordDisplay').textContent =
                    '*'.repeat(password.length) +
                    '_'.repeat(Math.max(0, maxLength - password.length));
            });
        });

        // Answer form submit handling
        document.getElementById('answerInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });
    </script>
</body>
</html>
